<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ronex Maths Helper | ZIMSEC Mathematics Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://www.desmos.com/api/v1.7/calculator.js?apiKey=dcb31709b452b1cf9dc26972add0fda6"></script>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #7209b7;
            --success: #4cc9f0;
            --warning: #f72585;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --border-radius: 12px;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        .dark-theme {
            --primary: #4895ef;
            --secondary: #560bad;
            --accent: #b5179e;
            --success: #4cc9f0;
            --warning: #f72585;
            --light: #121212;
            --dark: #e9ecef;
            --gray: #adb5bd;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
            transition: var(--transition);
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header & Navigation */
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .logo i {
            font-size: 2rem;
        }

        /* Enhanced Hamburger Menu */
        .hamburger-menu {
            display: none;
            flex-direction: column;
            justify-content: space-between;
            width: 30px;
            height: 21px;
            cursor: pointer;
            position: relative;
            z-index: 1001;
        }

        .hamburger-menu span {
            height: 3px;
            width: 100%;
            background-color: white;
            border-radius: 10px;
            transition: var(--transition);
            transform-origin: center;
        }

        /* Hamburger to X transformation */
        .hamburger-menu.active span:nth-child(1) {
            transform: rotate(45deg) translate(6px, 6px);
        }

        .hamburger-menu.active span:nth-child(2) {
            opacity: 0;
            transform: translateX(-10px);
        }

        .hamburger-menu.active span:nth-child(3) {
            transform: rotate(-45deg) translate(6px, -6px);
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
        }

        nav a:hover, nav a.active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .user-actions {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.7rem 1.5rem;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background-color: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--secondary);
            transform: translateY(-2px);
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid white;
            color: white;
        }

        .btn-outline:hover {
            background-color: white;
            color: var(--primary);
        }

        /* Mobile Navigation */
        .mobile-nav {
            position: fixed;
            top: 0;
            right: -100%;
            width: 80%;
            max-width: 300px;
            height: 100vh;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            z-index: 1000;
            transition: var(--transition);
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            overflow-y: auto;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.2);
        }

        .mobile-nav.active {
            right: 0;
        }

        .mobile-nav-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .mobile-nav-links {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .mobile-nav-links a {
            color: white;
            text-decoration: none;
            font-size: 1.2rem;
            padding: 1rem;
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .mobile-nav-links a:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .mobile-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .mobile-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Page System */
        .page {
            display: none;
            padding: 2rem 0;
            min-height: calc(100vh - 200px);
        }

        .page.active {
            display: block;
        }

        /* Login & Onboarding System */
        .login-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .login-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .login-container {
            background: white;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 500px;
            padding: 2rem;
            box-shadow: var(--shadow);
            position: relative;
        }

        .dark-theme .login-container {
            background: #1e1e1e;
            color: var(--dark);
        }

        .login-header {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .login-header h2 {
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .form-step {
            display: none;
        }

        .form-step.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--gray);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }

        .dark-theme .form-control {
            background: #2d2d2d;
            border-color: #444;
            color: var(--dark);
        }

        .form-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
        }

        .progress-bar {
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            margin-bottom: 1.5rem;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Dashboard */
        .dashboard {
            padding: 2rem 0;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .welcome-message h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .dashboard-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .dark-theme .dashboard-card {
            background: #1e1e1e;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .dashboard-card h3 {
            margin-bottom: 1rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .stat-item {
            text-align: center;
            padding: 1rem;
            border-radius: var(--border-radius);
            background: rgba(67, 97, 238, 0.1);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Hero Section */
        .hero {
            text-align: center;
            position: relative;
            overflow: hidden;
            padding: 4rem 0;
            background: linear-gradient(135deg, rgba(67, 97, 238, 0.1), rgba(58, 12, 163, 0.1));
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(to right, var(--primary), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .hero p {
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto 2rem;
            color: var(--gray);
        }

        .search-container {
            display: flex;
            max-width: 600px;
            margin: 0 auto 2rem;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .search-input {
            flex: 1;
            padding: 1rem;
            border: none;
            font-size: 1rem;
        }

        .search-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0 1.5rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .search-btn:hover {
            background: var(--secondary);
        }

        /* Features Section */
        .features {
            padding: 4rem 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 3rem;
            font-size: 2.5rem;
            color: var(--primary);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .feature-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            text-align: center;
            border-top: 5px solid var(--primary);
        }

        .dark-theme .feature-card {
            background: #1e1e1e;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .feature-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1.5rem;
        }

        /* Syllabus Section */
        .syllabus {
            padding: 4rem 0;
            background: rgba(67, 97, 238, 0.05);
        }

        .syllabus-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .syllabus-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
        }

        .dark-theme .syllabus-card {
            background: #1e1e1e;
        }

        .syllabus-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .syllabus-card h3 {
            color: var(--primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .syllabus-card ul {
            list-style: none;
            padding-left: 0;
        }

        .syllabus-card li {
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .dark-theme .syllabus-card li {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .syllabus-card li:last-child {
            border-bottom: none;
        }

        /* Ronex AI Assistant */
        .ai-assistant {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
        }

        .ai-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            border: none;
            box-shadow: var(--shadow);
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: var(--transition);
        }

        .ai-toggle:hover {
            transform: scale(1.1);
            background: var(--secondary);
        }

        .ai-chat {
            position: absolute;
            bottom: 70px;
            right: 0;
            width: 350px;
            height: 450px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
            transition: var(--transition);
        }

        .dark-theme .ai-chat {
            background: #1e1e1e;
        }

        .ai-chat.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .ai-header {
            padding: 1rem;
            background: var(--primary);
            color: white;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ai-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
        }

        .message {
            margin-bottom: 1rem;
            padding: 0.75rem;
            border-radius: var(--border-radius);
            max-width: 80%;
        }

        .message.user {
            background: var(--primary);
            color: white;
            margin-left: auto;
        }

        .message.bot {
            background: #f1f1f1;
            color: var(--dark);
        }

        .dark-theme .message.bot {
            background: #2d2d2d;
        }

        .ai-input {
            padding: 1rem;
            border-top: 1px solid #eee;
            display: flex;
            gap: 0.5rem;
        }

        .dark-theme .ai-input {
            border-top: 1px solid #444;
        }

        .ai-input input {
            flex: 1;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
        }

        .dark-theme .ai-input input {
            background: #2d2d2d;
            border-color: #444;
            color: var(--dark);
        }

        .ai-input button {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 0.5rem 1rem;
            cursor: pointer;
        }

        /* Tools Section */
        .tools {
            padding: 4rem 0;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .tool-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            text-align: center;
            cursor: pointer;
        }

        .dark-theme .tool-card {
            background: #1e1e1e;
        }

        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .tool-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        /* Progress Tracking */
        .progress-section {
            padding: 4rem 0;
            background: rgba(67, 97, 238, 0.05);
        }

        .progress-chart {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .dark-theme .progress-chart {
            background: #1e1e1e;
        }

        .progress-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        /* Settings */
        .settings {
            padding: 2rem 0;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .settings-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }

        .dark-theme .settings-card {
            background: #1e1e1e;
        }

        .settings-card h3 {
            margin-bottom: 1.5rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .dark-theme .setting-item {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: var(--transition);
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: var(--transition);
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* File Management */
        .file-management {
            padding: 2rem 0;
        }

        .upload-area {
            border: 2px dashed var(--gray);
            border-radius: var(--border-radius);
            padding: 2rem;
            text-align: center;
            margin-bottom: 2rem;
            transition: var(--transition);
        }

        .upload-area:hover {
            border-color: var(--primary);
        }

        .upload-area i {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .file-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            text-align: center;
        }

        .dark-theme .file-card {
            background: #1e1e1e;
        }

        .file-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .file-icon {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        /* Math Problems */
        .problems-section {
            padding: 2rem 0;
        }

        .problems-filter {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .problems-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .problem-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .dark-theme .problem-card {
            background: #1e1e1e;
        }

        .problem-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .problem-card h4 {
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .solution {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(67, 97, 238, 0.1);
            border-radius: var(--border-radius);
            display: none;
        }

        .solution.active {
            display: block;
        }

        /* Calculator */
        .calculator-container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .dark-theme .calculator-container {
            background: #1e1e1e;
        }

        .calculator-display {
            background: var(--dark);
            color: white;
            padding: 1.5rem;
            text-align: right;
            font-size: 1.5rem;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            word-break: break-all;
        }

        .calculator-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1px;
            background: var(--gray);
        }

        .calc-btn {
            background: white;
            border: none;
            padding: 1.5rem;
            font-size: 1.2rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .dark-theme .calc-btn {
            background: #2d2d2d;
            color: var(--dark);
        }

        .calc-btn:hover {
            background: #f0f0f0;
        }

        .dark-theme .calc-btn:hover {
            background: #3d3d3d;
        }

        .calc-btn.operator {
            background: var(--primary);
            color: white;
        }

        .calc-btn.operator:hover {
            background: var(--secondary);
        }

        /* Tool Containers */
        .tool-container {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-top: 2rem;
            display: none;
        }

        .dark-theme .tool-container {
            background: #1e1e1e;
        }

        .tool-container.active {
            display: block;
        }

        /* Graph Plotter */
        #graph-plotter {
            height: 500px;
            width: 100%;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
        }

        /* Equation Solver */
        .equation-input {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .equation-input input {
            flex: 1;
        }

        /* Formula Explorer */
        .formula-search {
            margin-bottom: 1.5rem;
        }

        .formulas-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .formula-card {
            background: rgba(67, 97, 238, 0.1);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            transition: var(--transition);
        }

        .formula-card:hover {
            transform: translateY(-5px);
        }

        /* Practice Generator */
        .practice-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        /* Notes Modal */
        .notes-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .notes-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .notes-container {
            background: white;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 800px;
            height: 80%;
            padding: 2rem;
            box-shadow: var(--shadow);
            position: relative;
            overflow-y: auto;
        }

        .dark-theme .notes-container {
            background: #1e1e1e;
        }

        .notes-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .close-notes {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        /* WhatsApp Modal */
        .whatsapp-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .whatsapp-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .whatsapp-container {
            background: white;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 500px;
            padding: 2rem;
            box-shadow: var(--shadow);
            position: relative;
        }

        .dark-theme .whatsapp-container {
            background: #1e1e1e;
        }

        .whatsapp-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .close-whatsapp {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        /* Quiz Section */
        .quiz-container {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-top: 2rem;
        }

        .dark-theme .quiz-container {
            background: #1e1e1e;
        }

        .quiz-question {
            margin-bottom: 1.5rem;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .quiz-option {
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }

        .quiz-option:hover {
            background: rgba(67, 97, 238, 0.1);
        }

        .quiz-option.selected {
            background: var(--primary);
            color: white;
        }

        .quiz-result {
            margin-top: 1.5rem;
            padding: 1rem;
            border-radius: var(--border-radius);
            display: none;
        }

        .quiz-result.correct {
            background: rgba(76, 201, 240, 0.2);
            border: 1px solid var(--success);
            display: block;
        }

        .quiz-result.incorrect {
            background: rgba(247, 37, 133, 0.2);
            border: 1px solid var(--warning);
            display: block;
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .hamburger-menu {
                display: flex;
            }
            
            nav ul {
                display: none;
            }
            
            .hero h1 {
                font-size: 2.5rem;
            }

            .ai-chat {
                width: 300px;
                height: 400px;
            }
        }

        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 1rem;
            }
            
            .features-grid, .syllabus-grid, .tools-grid, .files-grid, .problems-grid {
                grid-template-columns: 1fr;
            }
            
            .hero {
                padding: 2rem 0;
            }
            
            .hero h1 {
                font-size: 2rem;
            }

            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .ai-chat {
                width: calc(100vw - 40px);
                right: 20px;
            }

            .problems-filter {
                flex-direction: column;
            }

            .equation-input {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Login & Onboarding Modal -->
    <div class="login-modal active" id="loginModal">
        <div class="login-container">
            <div class="login-header">
                <h2>Welcome to Ronex Maths Helper</h2>
                <p>Personalize your learning experience</p>
            </div>
            
            <div class="progress-bar">
                <div class="progress" id="onboardingProgress"></div>
            </div>
            
            <!-- Step 1: User Info -->
            <div class="form-step active" id="step1">
                <div class="form-group">
                    <label for="userName">What's your name?</label>
                    <input type="text" id="userName" class="form-control" placeholder="Enter your name">
                </div>
                <div class="form-group">
                    <label for="userForm">Which form are you in?</label>
                    <select id="userForm" class="form-control">
                        <option value="">Select your form</option>
                        <option value="form1">Form 1</option>
                        <option value="form2">Form 2</option>
                        <option value="form3">Form 3</option>
                        <option value="form4">Form 4</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button class="btn btn-outline" disabled>Previous</button>
                    <button class="btn btn-primary" id="step1Next">Next</button>
                </div>
            </div>
            
            <!-- Step 2: Interests -->
            <div class="form-step" id="step2">
                <div class="form-group">
                    <label>Which math topics interest you most?</label>
                    <div class="interest-options">
                        <label class="checkbox-option">
                            <input type="checkbox" name="interests" value="algebra"> Algebra
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="interests" value="geometry"> Geometry
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="interests" value="trigonometry"> Trigonometry
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="interests" value="statistics"> Statistics
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="interests" value="calculus"> Calculus
                        </label>
                    </div>
                </div>
                <div class="form-actions">
                    <button class="btn btn-outline" id="step2Prev">Previous</button>
                    <button class="btn btn-primary" id="step2Next">Next</button>
                </div>
            </div>
            
            <!-- Step 3: Goals -->
            <div class="form-step" id="step3">
                <div class="form-group">
                    <label>What are your main goals?</label>
                    <div class="goal-options">
                        <label class="radio-option">
                            <input type="radio" name="goals" value="improve-grades"> Improve my grades
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="goals" value="prepare-exams"> Prepare for exams
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="goals" value="understand-concepts"> Better understand concepts
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="goals" value="build-foundation"> Build a strong foundation
                        </label>
                    </div>
                </div>
                <div class="form-actions">
                    <button class="btn btn-outline" id="step3Prev">Previous</button>
                    <button class="btn btn-primary" id="step3Complete">Get Started</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header>
        <div class="container nav-container">
            <div class="logo">
                <i class="fas fa-square-root-alt"></i>
                <span>Ronex Maths Helper</span>
            </div>
            
            <!-- Hamburger Menu -->
            <div class="hamburger-menu" id="hamburgerMenu">
                <span></span>
                <span></span>
                <span></span>
            </div>

            <nav>
                <ul>
                    <li><a href="#" class="nav-link active" data-page="dashboard">Dashboard</a></li>
                    <li><a href="#" class="nav-link" data-page="syllabus">Syllabus</a></li>
                    <li><a href="#" class="nav-link" data-page="problems">Math Problems</a></li>
                    <li><a href="#" class="nav-link" data-page="tools">Tools</a></li>
                    <li><a href="#" class="nav-link" data-page="files">Files</a></li>
                    <li><a href="#" class="nav-link" data-page="progress">Progress</a></li>
                    <li><a href="#" class="nav-link" data-page="resources">Resources</a></li>
                    <li><a href="#" class="nav-link" data-page="settings">Settings</a></li>
                </ul>
            </nav>
            <div class="nav-actions">
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                </button>
                <div class="user-actions">
                    <button class="btn btn-outline" id="logoutBtn">Logout</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Mobile Navigation -->
    <div class="mobile-overlay" id="mobileOverlay"></div>
    <div class="mobile-nav" id="mobileNav">
        <div class="mobile-nav-header">
            <div class="logo">
                <i class="fas fa-square-root-alt"></i>
                <span>Ronex Maths Helper</span>
            </div>
            <button class="btn btn-outline" id="closeMobileNav">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="mobile-nav-links">
            <a href="#" class="nav-link active" data-page="dashboard">Dashboard</a>
            <a href="#" class="nav-link" data-page="syllabus">Syllabus</a>
            <a href="#" class="nav-link" data-page="problems">Math Problems</a>
            <a href="#" class="nav-link" data-page="tools">Tools</a>
            <a href="#" class="nav-link" data-page="files">Files</a>
            <a href="#" class="nav-link" data-page="progress">Progress</a>
            <a href="#" class="nav-link" data-page="resources">Resources</a>
            <a href="#" class="nav-link" data-page="settings">Settings</a>
        </div>
    </div>

    <!-- Pages -->
    <main>
        <!-- Dashboard Page -->
        <section id="dashboard" class="page active">
            <div class="dashboard">
                <div class="container">
                    <div class="dashboard-header">
                        <div class="welcome-message">
                            <h1 id="welcomeText">Welcome, Student!</h1>
                            <p>Ready to master mathematics today?</p>
                        </div>
                        <div class="daily-challenge">
                            <div class="dashboard-card">
                                <h3><i class="fas fa-trophy"></i> Daily Challenge</h3>
                                <p id="dailyChallengeText">Solve today's challenge to earn points!</p>
                                <button class="btn btn-primary" style="margin-top: 1rem;" id="startChallengeBtn">Start Challenge</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="dashboard-grid">
                        <div class="dashboard-card">
                            <h3><i class="fas fa-chart-line"></i> Progress Overview</h3>
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <div class="stat-value" id="completedTopics">0</div>
                                    <div class="stat-label">Topics Completed</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="correctAnswers">0%</div>
                                    <div class="stat-label">Correct Answers</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="studyTime">0h</div>
                                    <div class="stat-label">Study Time</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="pointsEarned">0</div>
                                    <div class="stat-label">Points Earned</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <h3><i class="fas fa-book"></i> Recommended Topics</h3>
                            <div id="recommendedTopics">
                                <p>Based on your form and interests, we recommend:</p>
                                <ul>
                                    <li>Algebraic Expressions</li>
                                    <li>Linear Equations</li>
                                    <li>Geometry Basics</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <h3><i class="fas fa-clock"></i> Recent Activity</h3>
                            <div id="recentActivity">
                                <p>No recent activity yet. Start learning!</p>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <h3><i class="fas fa-calendar"></i> Upcoming Deadlines</h3>
                            <div id="upcomingDeadlines">
                                <p>No upcoming deadlines</p>
                            </div>
                        </div>
                    </div>

                    <!-- Live Quiz Section -->
                    <div class="quiz-container" id="dailyQuiz" style="display: none;">
                        <h3><i class="fas fa-puzzle-piece"></i> Daily Quiz</h3>
                        <div class="quiz-question" id="quizQuestion"></div>
                        <div class="quiz-options" id="quizOptions"></div>
                        <div class="quiz-result" id="quizResult"></div>
                        <button class="btn btn-primary" id="submitQuizBtn" style="display: none;">Submit Answer</button>
                        <button class="btn btn-outline" id="nextQuizBtn" style="display: none;">Next Question</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Syllabus Page -->
        <section id="syllabus" class="page">
            <div class="container">
                <h2 class="section-title">ZIMSEC Mathematics Syllabus</h2>
                <div class="syllabus-grid">
                    <div class="syllabus-card" data-form="form1">
                        <h3><i class="fas fa-calculator"></i> Form 1</h3>
                        <ul>
                            <li data-topic="number-systems">Number Systems</li>
                            <li data-topic="algebraic-expressions">Algebraic Expressions</li>
                            <li data-topic="basic-geometry">Basic Geometry</li>
                            <li data-topic="fractions-decimals">Fractions and Decimals</li>
                            <li data-topic="introduction-statistics">Introduction to Statistics</li>
                        </ul>
                    </div>
                    <div class="syllabus-card" data-form="form2">
                        <h3><i class="fas fa-shapes"></i> Form 2</h3>
                        <ul>
                            <li data-topic="linear-equations">Linear Equations</li>
                            <li data-topic="quadratic-expressions">Quadratic Expressions</li>
                            <li data-topic="coordinate-geometry">Coordinate Geometry</li>
                            <li data-topic="trigonometry-basics">Trigonometry Basics</li>
                            <li data-topic="probability">Probability</li>
                        </ul>
                    </div>
                    <div class="syllabus-card" data-form="form3">
                        <h3><i class="fas fa-chart-bar"></i> Form 3</h3>
                        <ul>
                            <li data-topic="quadratic-equations">Quadratic Equations</li>
                            <li data-topic="functions">Functions</li>
                            <li data-topic="circles-angles">Circles and Angles</li>
                            <li data-topic="statistics-data">Statistics and Data</li>
                            <li data-topic="vectors">Vectors</li>
                        </ul>
                    </div>
                    <div class="syllabus-card" data-form="form4">
                        <h3><i class="fas fa-infinity"></i> Form 4</h3>
                        <ul>
                            <li data-topic="calculus-basics">Calculus Basics</li>
                            <li data-topic="trigonometric-functions">Trigonometric Functions</li>
                            <li data-topic="3d-geometry">3D Geometry</li>
                            <li data-topic="matrices">Matrices</li>
                            <li data-topic="exam-preparation">Exam Preparation</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Math Problems Page -->
        <section id="problems" class="page">
            <div class="problems-section">
                <div class="container">
                    <h2 class="section-title">ZIMSEC Math Problems & Solutions</h2>
                    
                    <div class="problems-filter">
                        <select id="topicFilter" class="form-control">
                            <option value="all">All Topics</option>
                            <option value="algebra">Algebra</option>
                            <option value="geometry">Geometry</option>
                            <option value="trigonometry">Trigonometry</option>
                            <option value="statistics">Statistics</option>
                            <option value="calculus">Calculus</option>
                        </select>
                        <select id="formFilter" class="form-control">
                            <option value="all">All Forms</option>
                            <option value="form1">Form 1</option>
                            <option value="form2">Form 2</option>
                            <option value="form3">Form 3</option>
                            <option value="form4">Form 4</option>
                        </select>
                        <button class="btn btn-primary" id="searchProblemsBtn">
                            <i class="fas fa-search"></i> Search Problems
                        </button>
                        <button class="btn btn-outline" id="whatsappHelpBtn">
                            <i class="fab fa-whatsapp"></i> Get WhatsApp Help
                        </button>
                    </div>
                    
                    <div class="problems-grid" id="problemsContainer">
                        <!-- Problems will be dynamically loaded here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Tools Page -->
        <section id="tools" class="page">
            <div class="tools">
                <div class="container">
                    <h2 class="section-title">Mathematics Tools</h2>
                    <div class="tools-grid">
                        <div class="tool-card" id="calculatorTool">
                            <div class="tool-icon">
                                <i class="fas fa-calculator"></i>
                            </div>
                            <h3>Advanced Calculator</h3>
                            <p>Scientific calculator with graphing capabilities</p>
                        </div>
                        <div class="tool-card" id="scannerTool">
                            <div class="tool-icon">
                                <i class="fas fa-camera"></i>
                            </div>
                            <h3>Math Scanner</h3>
                            <p>Scan and solve printed or handwritten problems</p>
                        </div>
                        <div class="tool-card" id="graphTool">
                            <div class="tool-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h3>Graph Plotter</h3>
                            <p>Visualize functions and equations</p>
                        </div>
                        <div class="tool-card" id="equationSolverTool">
                            <div class="tool-icon">
                                <i class="fas fa-equals"></i>
                            </div>
                            <h3>Equation Solver</h3>
                            <p>Solve linear, quadratic, and simultaneous equations</p>
                        </div>
                        <div class="tool-card" id="formulaExplorerTool">
                            <div class="tool-icon">
                                <i class="fas fa-book"></i>
                            </div>
                            <h3>Formula Explorer</h3>
                            <p>Browse and search mathematical formulas</p>
                        </div>
                        <div class="tool-card" id="practiceGeneratorTool">
                            <div class="tool-icon">
                                <i class="fas fa-puzzle-piece"></i>
                            </div>
                            <h3>Practice Generator</h3>
                            <p>Generate custom practice problems</p>
                        </div>
                    </div>

                    <!-- Calculator Tool -->
                    <div id="calculatorContainer" class="tool-container">
                        <h3><i class="fas fa-calculator"></i> Advanced Calculator</h3>
                        <div class="calculator-container">
                            <div class="calculator-display" id="calcDisplay">0</div>
                            <div class="calculator-buttons">
                                <button class="calc-btn" data-action="clear">C</button>
                                <button class="calc-btn" data-action="backspace"></button>
                                <button class="calc-btn operator" data-action="percentage">%</button>
                                <button class="calc-btn operator" data-action="divide"></button>
                                
                                <button class="calc-btn" data-value="7">7</button>
                                <button class="calc-btn" data-value="8">8</button>
                                <button class="calc-btn" data-value="9">9</button>
                                <button class="calc-btn operator" data-action="multiply"></button>
                                
                                <button class="calc-btn" data-value="4">4</button>
                                <button class="calc-btn" data-value="5">5</button>
                                <button class="calc-btn" data-value="6">6</button>
                                <button class="calc-btn operator" data-action="subtract">-</button>
                                
                                <button class="calc-btn" data-value="1">1</button>
                                <button class="calc-btn" data-value="2">2</button>
                                <button class="calc-btn" data-value="3">3</button>
                                <button class="calc-btn operator" data-action="add">+</button>
                                
                                <button class="calc-btn" data-value="0" style="grid-column: span 2;">0</button>
                                <button class="calc-btn" data-value=".">.</button>
                                <button class="calc-btn operator" data-action="calculate">=</button>
                            </div>
                        </div>
                    </div>

                    <!-- Graph Plotter Tool -->
                    <div id="graphPlotterContainer" class="tool-container">
                        <h3><i class="fas fa-chart-line"></i> Graph Plotter</h3>
                        <div class="equation-input">
                            <input type="text" id="graphEquation" class="form-control" placeholder="Enter function (e.g., x^2, sin(x), 2x+3)">
                            <button class="btn btn-primary" id="plotGraphBtn">Plot Graph</button>
                        </div>
                        <div id="graph-plotter"></div>
                    </div>

                    <!-- Equation Solver Tool -->
                    <div id="equationSolverContainer" class="tool-container">
                        <h3><i class="fas fa-equals"></i> Equation Solver</h3>
                        <div class="equation-input">
                            <input type="text" id="equationInput" class="form-control" placeholder="Enter equation (e.g., 2x+5=13, x^2-4=0)">
                            <button class="btn btn-primary" id="solveEquationBtn">Solve Equation</button>
                        </div>
                        <div id="equationResult" style="margin-top: 1.5rem;"></div>
                    </div>

                    <!-- Formula Explorer Tool -->
                    <div id="formulaExplorerContainer" class="tool-container">
                        <h3><i class="fas fa-book"></i> Formula Explorer</h3>
                        <div class="formula-search">
                            <input type="text" id="formulaSearch" class="form-control" placeholder="Search formulas...">
                        </div>
                        <div class="formulas-grid" id="formulasContainer">
                            <!-- Formulas will be dynamically loaded here -->
                        </div>
                    </div>

                    <!-- Practice Generator Tool -->
                    <div id="practiceGeneratorContainer" class="tool-container">
                        <h3><i class="fas fa-puzzle-piece"></i> Practice Generator</h3>
                        <div class="practice-options">
                            <select id="practiceTopic" class="form-control">
                                <option value="algebra">Algebra</option>
                                <option value="geometry">Geometry</option>
                                <option value="trigonometry">Trigonometry</option>
                                <option value="statistics">Statistics</option>
                                <option value="calculus">Calculus</option>
                            </select>
                            <select id="practiceForm" class="form-control">
                                <option value="form1">Form 1</option>
                                <option value="form2">Form 2</option>
                                <option value="form3">Form 3</option>
                                <option value="form4">Form 4</option>
                            </select>
                            <select id="practiceDifficulty" class="form-control">
                                <option value="easy">Easy</option>
                                <option value="medium">Medium</option>
                                <option value="hard">Hard</option>
                            </select>
                            <button class="btn btn-primary" id="generatePracticeBtn">Generate Problems</button>
                        </div>
                        <div id="practiceProblems" style="margin-top: 1.5rem;"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Files Page -->
        <section id="files" class="page">
            <div class="file-management">
                <div class="container">
                    <h2 class="section-title">File Management</h2>
                    
                    <div class="upload-area" id="uploadArea">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <h3>Upload PDFs and Documents</h3>
                        <p>Drag and drop files here or click to browse</p>
                        <input type="file" id="fileInput" accept=".pdf,.doc,.docx,.txt" multiple style="display: none;">
                        <button class="btn btn-primary" style="margin-top: 1rem;" id="browseFilesBtn">Browse Files</button>
                    </div>
                    
                    <div class="files-grid" id="filesContainer">
                        <!-- Files will be dynamically loaded here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Progress Page -->
        <section id="progress" class="page">
            <div class="progress-section">
                <div class="container">
                    <h2 class="section-title">Your Progress</h2>
                    <div class="progress-chart">
                        <canvas id="progressChart" height="100"></canvas>
                    </div>
                    <div class="progress-grid">
                        <div class="dashboard-card">
                            <h3><i class="fas fa-tasks"></i> Topic Completion</h3>
                            <div id="topicProgress">
                                <p>Algebra: 30%</p>
                                <p>Geometry: 15%</p>
                                <p>Trigonometry: 5%</p>
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <h3><i class="fas fa-award"></i> Achievements</h3>
                            <div id="achievementsList">
                                <p>No achievements yet. Keep learning!</p>
                            </div>
                        </div>
                        <div class="dashboard-card">
                            <h3><i class="fas fa-history"></i> Study History</h3>
                            <div id="studyHistory">
                                <p>No study sessions recorded yet.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Resources Page -->
        <section id="resources" class="page">
            <div class="container">
                <h2 class="section-title">Learning Resources</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <h3>Past Exam Papers</h3>
                        <p>Download ZIMSEC past exam papers with marking schemes.</p>
                        <button class="btn btn-primary" style="margin-top: 1rem;" onclick="window.open('https://www.zimsec.co.zw/zimsec-past-exam-papers/', '_blank')">Browse Papers</button>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-video"></i>
                        </div>
                        <h3>Video Lessons</h3>
                        <p>Watch detailed explanations of complex topics.</p>
                        <button class="btn btn-primary" style="margin-top: 1rem;" onclick="window.open('https://www.khanacademy.org/math', '_blank')">Watch Videos</button>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-download"></i>
                        </div>
                        <h3>Downloadable Notes</h3>
                        <p>Access comprehensive notes for offline studying.</p>
                        <button class="btn btn-primary" style="margin-top: 1rem;" id="downloadNotesBtn">Download Notes</button>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-external-link-alt"></i>
                        </div>
                        <h3>External Resources</h3>
                        <p>Links to Khan Academy, ZIMSEC portal, and other helpful sites.</p>
                        <button class="btn btn-primary" style="margin-top: 1rem;" onclick="window.open('https://www.zimsec.co.zw', '_blank')">Explore Resources</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Settings Page -->
        <section id="settings" class="page">
            <div class="settings">
                <div class="container">
                    <h2 class="section-title">Settings</h2>
                    <div class="settings-grid">
                        <div class="settings-card">
                            <h3><i class="fas fa-user"></i> Profile</h3>
                            <div class="setting-item">
                                <span>Name</span>
                                <span id="profileName">Student</span>
                            </div>
                            <div class="setting-item">
                                <span>Form</span>
                                <span id="profileForm">Not set</span>
                            </div>
                            <div class="setting-item">
                                <span>Interests</span>
                                <span id="profileInterests">Not set</span>
                            </div>
                            <div class="setting-item">
                                <span>Goals</span>
                                <span id="profileGoals">Not set</span>
                            </div>
                            <button class="btn btn-outline" style="margin-top: 1rem; width: 100%;" id="editProfileBtn">Edit Profile</button>
                        </div>
                        
                        <div class="settings-card">
                            <h3><i class="fas fa-palette"></i> Appearance</h3>
                            <div class="setting-item">
                                <span>Dark Mode</span>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="darkModeToggle">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <span>Language</span>
                                <select id="languageSelect" class="form-control" style="width: auto;">
                                    <option value="en">English</option>
                                    <option value="sn">Shona</option>
                                    <option value="nd">Ndebele</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <span>Font Size</span>
                                <select id="fontSizeSelect" class="form-control" style="width: auto;">
                                    <option value="small">Small</option>
                                    <option value="medium" selected>Medium</option>
                                    <option value="large">Large</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="settings-card">
                            <h3><i class="fas fa-bell"></i> Notifications</h3>
                            <div class="setting-item">
                                <span>Daily Reminders</span>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="dailyRemindersToggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <span>Study Goals</span>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="studyGoalsToggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <span>Challenge Notifications</span>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="challengeNotificationsToggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="settings-card">
                            <h3><i class="fas fa-database"></i> Data & Storage</h3>
                            <div class="setting-item">
                                <span>Offline Mode</span>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="offlineModeToggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <span>Cache Size</span>
                                <span id="cacheSize">15.2 MB</span>
                            </div>
                            <div class="setting-item">
                                <span>Developer</span>
                                <span>Glorify Mutuwa</span>
                            </div>
                            <button class="btn btn-outline" style="margin-top: 1rem; width: 100%;" id="backupDataBtn">Backup Data</button>
                            <button class="btn btn-outline" style="margin-top: 0.5rem; width: 100%;" id="clearCacheBtn">Clear Cache</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Notes Modal -->
    <div class="notes-modal" id="notesModal">
        <div class="notes-container">
            <div class="notes-header">
                <h2 id="notesTitle">Topic Notes</h2>
                <button class="close-notes" id="closeNotesBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="notesContent">
                <!-- Notes content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- WhatsApp Modal -->
    <div class="whatsapp-modal" id="whatsappModal">
        <div class="whatsapp-container">
            <div class="whatsapp-header">
                <h2>Get Help from Ronex via WhatsApp</h2>
                <button class="close-whatsapp" id="closeWhatsAppBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="form-group">
                <label for="problemDescription">Describe the problem you're struggling with:</label>
                <textarea id="problemDescription" class="form-control" rows="4" placeholder="Enter the math problem here..."></textarea>
            </div>
            <div class="form-group">
                <label for="whatsappForm">Which form is this problem from?</label>
                <select id="whatsappForm" class="form-control">
                    <option value="form1">Form 1</option>
                    <option value="form2">Form 2</option>
                    <option value="form3">Form 3</option>
                    <option value="form4">Form 4</option>
                </select>
            </div>
            <div class="form-group">
                <label for="whatsappTopic">What topic is this problem related to?</label>
                <select id="whatsappTopic" class="form-control">
                    <option value="algebra">Algebra</option>
                    <option value="geometry">Geometry</option>
                    <option value="trigonometry">Trigonometry</option>
                    <option value="statistics">Statistics</option>
                    <option value="calculus">Calculus</option>
                </select>
            </div>
            <div class="form-group">
                <label for="attemptedSolution">What have you tried so far to solve it?</label>
                <textarea id="attemptedSolution" class="form-control" rows="3" placeholder="Describe what you've attempted..."></textarea>
            </div>
            <div class="form-group">
                <label for="specificDifficulty">What specific part are you finding difficult?</label>
                <textarea id="specificDifficulty" class="form-control" rows="2" placeholder="Explain where you're stuck..."></textarea>
            </div>
            <button class="btn btn-primary" style="width: 100%; margin-top: 1rem;" id="sendWhatsAppBtn">
                <i class="fab fa-whatsapp"></i> Send to Ronex via WhatsApp
            </button>
        </div>
    </div>

    <!-- Ronex AI Assistant -->
    <div class="ai-assistant">
        <div class="ai-chat" id="aiChat">
            <div class="ai-header">
                <span>Ronex AI Assistant</span>
                <button id="closeAiChat"><i class="fas fa-times"></i></button>
            </div>
            <div class="ai-messages" id="aiMessages">
                <div class="message bot">
                    Hello! I'm Ronex, your math assistant. How can I help you today?
                </div>
            </div>
            <div class="ai-input">
                <input type="text" id="aiInput" placeholder="Type your math question...">
                <button id="sendAiMessage"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
        <button class="ai-toggle" id="aiToggle">
            <i class="fas fa-robot"></i>
        </button>
    </div>

    <script>
        // User Data Management
        let userData = {
            name: "",
            form: "",
            interests: [],
            goals: "",
            progress: {
                completedTopics: 0,
                correctAnswers: 0,
                totalQuestions: 0,
                studyTime: 0,
                points: 0,
                dailyChallengeCompleted: false,
                quizScore: 0,
                problemsSolved: 0
            },
            settings: {
                theme: "light",
                language: "en",
                fontSize: "medium",
                notifications: {
                    dailyReminders: true,
                    studyGoals: true,
                    challenges: true
                },
                offlineMode: true
            }
        };

        // ZIMSEC Math Problems Database
        const mathProblems = [
            {
                id: 1,
                topic: "algebra",
                form: "form1",
                question: "Simplify: 3x + 2y - x + 5y",
                solution: "Combine like terms: (3x - x) + (2y + 5y) = 2x + 7y",
                notes: "When simplifying algebraic expressions, combine terms with the same variables."
            },
            {
                id: 2,
                topic: "algebra",
                form: "form1",
                question: "Solve for x: 2x + 5 = 13",
                solution: "2x + 5 = 13  2x = 13 - 5  2x = 8  x = 4",
                notes: "Isolate the variable by performing inverse operations on both sides of the equation."
            },
            {
                id: 3,
                topic: "geometry",
                form: "form1",
                question: "Calculate the area of a circle with radius 7cm. (Use  = 22/7)",
                solution: "Area = r = (22/7)  7 = (22/7)  49 = 22  7 = 154 cm",
                notes: "The formula for the area of a circle is r, where r is the radius."
            },
            {
                id: 4,
                topic: "geometry",
                form: "form2",
                question: "Find the perimeter of a rectangle with length 8cm and width 5cm.",
                solution: "Perimeter = 2(length + width) = 2(8 + 5) = 2  13 = 26 cm",
                notes: "The perimeter of a rectangle is twice the sum of its length and width."
            },
            {
                id: 5,
                topic: "trigonometry",
                form: "form2",
                question: "In a right-angled triangle, if the opposite side is 6cm and the hypotenuse is 10cm, find sin .",
                solution: "sin  = opposite/hypotenuse = 6/10 = 3/5 = 0.6",
                notes: "Remember the trigonometric ratio SOH-CAH-TOA: Sine = Opposite/Hypotenuse."
            },
            {
                id: 6,
                topic: "algebra",
                form: "form2",
                question: "Expand: (x + 3)(x + 4)",
                solution: "Using FOIL method: x*x + x*4 + 3*x + 3*4 = x + 4x + 3x + 12 = x + 7x + 12",
                notes: "Use the FOIL method (First, Outer, Inner, Last) to expand binomials."
            },
            {
                id: 7,
                topic: "statistics",
                form: "form3",
                question: "Find the mean of: 5, 8, 7, 5, 10",
                solution: "Mean = (5+8+7+5+10)/5 = 35/5 = 7",
                notes: "The mean is the sum of all values divided by the number of values."
            },
            {
                id: 8,
                topic: "algebra",
                form: "form3",
                question: "Factorize: x + 5x + 6",
                solution: "Find two numbers that multiply to 6 and add to 5: 2 and 3. So, x + 5x + 6 = (x+2)(x+3)",
                notes: "For quadratic expressions of the form x + bx + c, find factors of c that add up to b."
            },
            {
                id: 9,
                topic: "geometry",
                form: "form3",
                question: "Calculate the volume of a cylinder with radius 3cm and height 10cm. (Use  = 3.14)",
                solution: "Volume = rh = 3.14  3  10 = 3.14  9  10 = 282.6 cm",
                notes: "The volume of a cylinder is the area of its base (r) times its height (h)."
            },
            {
                id: 10,
                topic: "trigonometry",
                form: "form3",
                question: "If tan  = 3/4, find sin  and cos .",
                solution: "If tan  = 3/4, then opposite = 3, adjacent = 4. Hypotenuse = (3+4) = (9+16) = 25 = 5. So sin  = 3/5, cos  = 4/5",
                notes: "Use the Pythagorean theorem to find the hypotenuse when you know two sides of a right triangle."
            }
        ];

        // ZIMSEC Syllabus Notes Database
        const syllabusNotes = {
            "number-systems": {
                title: "Number Systems",
                content: `
                    <h3>Number Systems</h3>
                    <p>Number systems are the foundation of mathematics. They include:</p>
                    <ul>
                        <li><strong>Natural Numbers:</strong> Counting numbers (1, 2, 3, ...)</li>
                        <li><strong>Whole Numbers:</strong> Natural numbers including zero (0, 1, 2, 3, ...)</li>
                        <li><strong>Integers:</strong> Positive and negative whole numbers (..., -3, -2, -1, 0, 1, 2, 3, ...)</li>
                        <li><strong>Rational Numbers:</strong> Numbers that can be expressed as fractions (a/b where b  0)</li>
                        <li><strong>Irrational Numbers:</strong> Numbers that cannot be expressed as fractions (e.g., , 2)</li>
                        <li><strong>Real Numbers:</strong> All rational and irrational numbers</li>
                    </ul>
                    <h4>Key Concepts:</h4>
                    <p><strong>Place Value:</strong> The value of a digit depends on its position in a number.</p>
                    <p><strong>Prime Numbers:</strong> Numbers greater than 1 that have only two factors: 1 and themselves.</p>
                    <p><strong>Factors and Multiples:</strong> Factors are numbers that divide exactly into another number. Multiples are the results of multiplying a number by integers.</p>
                    <h4>Example Problems:</h4>
                    <p>1. Identify whether 17 is a prime number.</p>
                    <p><strong>Solution:</strong> 17 is only divisible by 1 and 17, so it is a prime number.</p>
                    <p>2. Find the factors of 24.</p>
                    <p><strong>Solution:</strong> 1, 2, 3, 4, 6, 8, 12, 24</p>
                `
            },
            "algebraic-expressions": {
                title: "Algebraic Expressions",
                content: `
                    <h3>Algebraic Expressions</h3>
                    <p>Algebraic expressions are combinations of variables, numbers, and operations.</p>
                    <h4>Key Concepts:</h4>
                    <p><strong>Variables:</strong> Symbols (usually letters) that represent unknown values.</p>
                    <p><strong>Constants:</strong> Fixed values that don't change.</p>
                    <p><strong>Coefficients:</strong> Numbers multiplying variables.</p>
                    <p><strong>Terms:</strong> Parts of an expression separated by + or - signs.</p>
                    <p><strong>Like Terms:</strong> Terms with the same variables raised to the same powers.</p>
                    <h4>Operations with Algebraic Expressions:</h4>
                    <p><strong>Simplifying:</strong> Combine like terms.</p>
                    <p><strong>Expanding:</strong> Multiply out brackets using the distributive property.</p>
                    <p><strong>Factorizing:</strong> Express an expression as a product of factors.</p>
                    <h4>Example Problems:</h4>
                    <p>1. Simplify: 3x + 2y - x + 5y</p>
                    <p><strong>Solution:</strong> (3x - x) + (2y + 5y) = 2x + 7y</p>
                    <p>2. Expand: 2(x + 3)</p>
                    <p><strong>Solution:</strong> 2x + 23 = 2x + 6</p>
                    <p>3. Factorize: 4x + 8</p>
                    <p><strong>Solution:</strong> 4(x + 2)</p>
                `
            },
            "basic-geometry": {
                title: "Basic Geometry",
                content: `
                    <h3>Basic Geometry</h3>
                    <p>Geometry is the study of shapes, sizes, and properties of space.</p>
                    <h4>Key Concepts:</h4>
                    <p><strong>Points, Lines, and Planes:</strong> Fundamental building blocks of geometry.</p>
                    <p><strong>Angles:</strong> Formed by two rays with a common endpoint.</p>
                    <p><strong>Polygons:</strong> Closed figures with straight sides.</p>
                    <p><strong>Circles:</strong> Set of all points equidistant from a center point.</p>
                    <h4>Formulas:</h4>
                    <p><strong>Perimeter:</strong> Distance around a shape.</p>
                    <p><strong>Area:</strong> Amount of space inside a shape.</p>
                    <p><strong>Volume:</strong> Amount of space inside a 3D shape.</p>
                    <h4>Example Problems:</h4>
                    <p>1. Find the area of a rectangle with length 8cm and width 5cm.</p>
                    <p><strong>Solution:</strong> Area = length  width = 8  5 = 40 cm</p>
                    <p>2. Calculate the circumference of a circle with radius 7cm. (Use  = 22/7)</p>
                    <p><strong>Solution:</strong> Circumference = 2r = 2  (22/7)  7 = 44 cm</p>
                `
            },
            "linear-equations": {
                title: "Linear Equations",
                content: `
                    <h3>Linear Equations</h3>
                    <p>Linear equations are equations where the highest power of the variable is 1.</p>
                    <h4>Key Concepts:</h4>
                    <p><strong>Solving Linear Equations:</strong> Isolate the variable on one side of the equation.</p>
                    <p><strong>Graphing Linear Equations:</strong> Plotting points that satisfy the equation to form a straight line.</p>
                    <p><strong>Slope:</strong> Measure of the steepness of a line.</p>
                    <p><strong>Intercepts:</strong> Points where the line crosses the axes.</p>
                    <h4>Methods for Solving:</h4>
                    <p><strong>Inverse Operations:</strong> Undo operations to isolate the variable.</p>
                    <p><strong>Balancing Method:</strong> Perform the same operation on both sides of the equation.</p>
                    <h4>Example Problems:</h4>
                    <p>1. Solve for x: 2x + 5 = 13</p>
                    <p><strong>Solution:</strong> 2x = 13 - 5  2x = 8  x = 4</p>
                    <p>2. Solve for y: 3y - 7 = 8</p>
                    <p><strong>Solution:</strong> 3y = 8 + 7  3y = 15  y = 5</p>
                `
            }
            // Additional notes would continue for all topics
        };

        // Math Formulas Database
        const mathFormulas = [
            {
                id: 1,
                name: "Pythagorean Theorem",
                formula: "a + b = c",
                description: "In a right triangle, the square of the hypotenuse equals the sum of squares of the other two sides.",
                topic: "geometry"
            },
            {
                id: 2,
                name: "Quadratic Formula",
                formula: "x = [-b  (b - 4ac)] / 2a",
                description: "Formula to find the roots of a quadratic equation ax + bx + c = 0.",
                topic: "algebra"
            },
            {
                id: 3,
                name: "Area of a Circle",
                formula: "A = r",
                description: "Area equals pi times the square of the radius.",
                topic: "geometry"
            },
            {
                id: 4,
                name: "Volume of a Cylinder",
                formula: "V = rh",
                description: "Volume equals pi times radius squared times height.",
                topic: "geometry"
            },
            {
                id: 5,
                name: "Slope of a Line",
                formula: "m = (y - y) / (x - x)",
                description: "Slope equals the change in y divided by the change in x between two points.",
                topic: "algebra"
            },
            {
                id: 6,
                name: "Distance Formula",
                formula: "d = [(x - x) + (y - y)]",
                description: "Distance between two points in a coordinate plane.",
                topic: "geometry"
            },
            {
                id: 7,
                name: "Sine Rule",
                formula: "a/sinA = b/sinB = c/sinC",
                description: "Ratio of side length to sine of opposite angle is constant in any triangle.",
                topic: "trigonometry"
            },
            {
                id: 8,
                name: "Cosine Rule",
                formula: "a = b + c - 2bc cosA",
                description: "Relates side lengths to angles in any triangle.",
                topic: "trigonometry"
            }
        ];

        // Daily Quiz Questions
        const quizQuestions = [
            {
                id: 1,
                question: "What is the value of 3x + 5 when x = 4?",
                options: ["12", "17", "15", "20"],
                correctAnswer: 1,
                explanation: "Substitute x = 4: 3(4) + 5 = 12 + 5 = 17"
            },
            {
                id: 2,
                question: "What is the area of a rectangle with length 8cm and width 5cm?",
                options: ["13 cm", "40 cm", "26 cm", "45 cm"],
                correctAnswer: 1,
                explanation: "Area = length  width = 8  5 = 40 cm"
            },
            {
                id: 3,
                question: "Solve for x: 2x - 7 = 11",
                options: ["x = 2", "x = 9", "x = 18", "x = 4"],
                correctAnswer: 1,
                explanation: "2x - 7 = 11  2x = 11 + 7  2x = 18  x = 9"
            },
            {
                id: 4,
                question: "What is the value of 5 + 3?",
                options: ["34", "52", "28", "45"],
                correctAnswer: 1,
                explanation: "5 = 25, 3 = 27, so 25 + 27 = 52"
            },
            {
                id: 5,
                question: "If a triangle has angles of 30 and 60, what is the third angle?",
                options: ["60", "90", "120", "30"],
                correctAnswer: 1,
                explanation: "Sum of angles in a triangle is 180, so 180 - 30 - 60 = 90"
            }
        ];

        // DOM Elements
        const loginModal = document.getElementById('loginModal');
        const onboardingProgress = document.getElementById('onboardingProgress');
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');
        const step3 = document.getElementById('step3');
        const step1Next = document.getElementById('step1Next');
        const step2Prev = document.getElementById('step2Prev');
        const step2Next = document.getElementById('step2Next');
        const step3Prev = document.getElementById('step3Prev');
        const step3Complete = document.getElementById('step3Complete');
        
        const welcomeText = document.getElementById('welcomeText');
        const completedTopics = document.getElementById('completedTopics');
        const correctAnswers = document.getElementById('correctAnswers');
        const studyTime = document.getElementById('studyTime');
        const pointsEarned = document.getElementById('pointsEarned');
        const dailyChallengeText = document.getElementById('dailyChallengeText');
        
        const profileName = document.getElementById('profileName');
        const profileForm = document.getElementById('profileForm');
        const profileInterests = document.getElementById('profileInterests');
        const profileGoals = document.getElementById('profileGoals');
        
        const aiToggle = document.getElementById('aiToggle');
        const aiChat = document.getElementById('aiChat');
        const closeAiChat = document.getElementById('closeAiChat');
        const aiMessages = document.getElementById('aiMessages');
        const aiInput = document.getElementById('aiInput');
        const sendAiMessage = document.getElementById('sendAiMessage');
        
        const darkModeToggle = document.getElementById('darkModeToggle');
        const languageSelect = document.getElementById('languageSelect');
        const fontSizeSelect = document.getElementById('fontSizeSelect');
        const offlineModeToggle = document.getElementById('offlineModeToggle');
        const logoutBtn = document.getElementById('logoutBtn');
        const clearCacheBtn = document.getElementById('clearCacheBtn');
        const editProfileBtn = document.getElementById('editProfileBtn');
        const startChallengeBtn = document.getElementById('startChallengeBtn');
        const downloadNotesBtn = document.getElementById('downloadNotesBtn');
        const backupDataBtn = document.getElementById('backupDataBtn');
        const browseFilesBtn = document.getElementById('browseFilesBtn');
        const fileInput = document.getElementById('fileInput');
        const uploadArea = document.getElementById('uploadArea');
        const filesContainer = document.getElementById('filesContainer');
        const problemsContainer = document.getElementById('problemsContainer');
        const topicFilter = document.getElementById('topicFilter');
        const formFilter = document.getElementById('formFilter');
        const searchProblemsBtn = document.getElementById('searchProblemsBtn');
        const whatsappHelpBtn = document.getElementById('whatsappHelpBtn');
        
        const calculatorTool = document.getElementById('calculatorTool');
        const calculatorContainer = document.getElementById('calculatorContainer');
        const calcDisplay = document.getElementById('calcDisplay');
        const calcButtons = document.querySelectorAll('.calc-btn');
        
        const graphTool = document.getElementById('graphTool');
        const graphPlotterContainer = document.getElementById('graphPlotterContainer');
        const graphEquation = document.getElementById('graphEquation');
        const plotGraphBtn = document.getElementById('plotGraphBtn');
        
        const equationSolverTool = document.getElementById('equationSolverTool');
        const equationSolverContainer = document.getElementById('equationSolverContainer');
        const equationInput = document.getElementById('equationInput');
        const solveEquationBtn = document.getElementById('solveEquationBtn');
        const equationResult = document.getElementById('equationResult');
        
        const formulaExplorerTool = document.getElementById('formulaExplorerTool');
        const formulaExplorerContainer = document.getElementById('formulaExplorerContainer');
        const formulaSearch = document.getElementById('formulaSearch');
        const formulasContainer = document.getElementById('formulasContainer');
        
        const practiceGeneratorTool = document.getElementById('practiceGeneratorTool');
        const practiceGeneratorContainer = document.getElementById('practiceGeneratorContainer');
        const practiceTopic = document.getElementById('practiceTopic');
        const practiceForm = document.getElementById('practiceForm');
        const practiceDifficulty = document.getElementById('practiceDifficulty');
        const generatePracticeBtn = document.getElementById('generatePracticeBtn');
        const practiceProblems = document.getElementById('practiceProblems');
        
        const notesModal = document.getElementById('notesModal');
        const notesTitle = document.getElementById('notesTitle');
        const notesContent = document.getElementById('notesContent');
        const closeNotesBtn = document.getElementById('closeNotesBtn');
        
        const whatsappModal = document.getElementById('whatsappModal');
        const closeWhatsAppBtn = document.getElementById('closeWhatsAppBtn');
        const problemDescription = document.getElementById('problemDescription');
        const whatsappForm = document.getElementById('whatsappForm');
        const whatsappTopic = document.getElementById('whatsappTopic');
        const attemptedSolution = document.getElementById('attemptedSolution');
        const specificDifficulty = document.getElementById('specificDifficulty');
        const sendWhatsAppBtn = document.getElementById('sendWhatsAppBtn');
        
        const dailyQuiz = document.getElementById('dailyQuiz');
        const quizQuestion = document.getElementById('quizQuestion');
        const quizOptions = document.getElementById('quizOptions');
        const quizResult = document.getElementById('quizResult');
        const submitQuizBtn = document.getElementById('submitQuizBtn');
        const nextQuizBtn = document.getElementById('nextQuizBtn');

        // Calculator State
        let calculatorState = {
            currentValue: '0',
            previousValue: null,
            operation: null,
            waitingForNewValue: false
        };

        // Quiz State
        let quizState = {
            currentQuestion: 0,
            score: 0,
            selectedOption: null,
            quizActive: false
        };

        // Graph Calculator
        let elt = document.getElementById('graph-plotter');
        let calculator = Desmos.GraphingCalculator(elt, {
            keypad: false,
            expressions: false
        });

        // Onboarding Process
        let currentStep = 1;
        const totalSteps = 3;

        function updateProgressBar() {
            const progress = (currentStep / totalSteps) * 100;
            onboardingProgress.style.width = `${progress}%`;
        }

        function showStep(stepNumber) {
            document.querySelectorAll('.form-step').forEach(step => {
                step.classList.remove('active');
            });
            document.getElementById(`step${stepNumber}`).classList.add('active');
            currentStep = stepNumber;
            updateProgressBar();
        }

        step1Next.addEventListener('click', () => {
            const userName = document.getElementById('userName').value;
            const userForm = document.getElementById('userForm').value;
            
            if (userName && userForm) {
                userData.name = userName;
                userData.form = userForm;
                showStep(2);
            } else {
                alert('Please fill in all fields');
            }
        });

        step2Prev.addEventListener('click', () => {
            showStep(1);
        });

        step2Next.addEventListener('click', () => {
            const interestCheckboxes = document.querySelectorAll('input[name="interests"]:checked');
            if (interestCheckboxes.length > 0) {
                userData.interests = Array.from(interestCheckboxes).map(cb => cb.value);
                showStep(3);
            } else {
                alert('Please select at least one interest');
            }
        });

        step3Prev.addEventListener('click', () => {
            showStep(2);
        });

        step3Complete.addEventListener('click', () => {
            const goalRadio = document.querySelector('input[name="goals"]:checked');
            if (goalRadio) {
                userData.goals = goalRadio.value;
                completeOnboarding();
            } else {
                alert('Please select a goal');
            }
        });

        function completeOnboarding() {
            // Save user data to localStorage
            localStorage.setItem('ronexMathUser', JSON.stringify(userData));
            
            // Hide login modal
            loginModal.classList.remove('active');
            
            // Update UI with user data
            updateDashboard();
            updateSettingsDisplay();
        }

        function updateDashboard() {
            welcomeText.textContent = `Welcome, ${userData.name}!`;
            completedTopics.textContent = userData.progress.completedTopics;
            correctAnswers.textContent = userData.progress.totalQuestions > 0 
                ? `${Math.round((userData.progress.correctAnswers / userData.progress.totalQuestions) * 100)}%` 
                : "0%";
            studyTime.textContent = `${userData.progress.studyTime}h`;
            pointsEarned.textContent = userData.progress.points;
            
            // Update daily challenge text
            if (userData.progress.dailyChallengeCompleted) {
                dailyChallengeText.textContent = "You've completed today's challenge! Come back tomorrow for a new one.";
                startChallengeBtn.textContent = "Challenge Completed";
                startChallengeBtn.disabled = true;
            } else {
                dailyChallengeText.textContent = "Solve today's challenge to earn points!";
                startChallengeBtn.textContent = "Start Challenge";
                startChallengeBtn.disabled = false;
            }
            
            // Update recommended topics based on form and interests
            updateRecommendedTopics();
        }

        function updateRecommendedTopics() {
            const recommendedTopics = document.getElementById('recommendedTopics');
            let topics = [];
            
            if (userData.form === 'form1') {
                topics = ['Number Systems', 'Algebraic Expressions', 'Basic Geometry'];
            } else if (userData.form === 'form2') {
                topics = ['Linear Equations', 'Quadratic Expressions', 'Coordinate Geometry'];
            } else if (userData.form === 'form3') {
                topics = ['Quadratic Equations', 'Functions', 'Circles and Angles'];
            } else if (userData.form === 'form4') {
                topics = ['Calculus Basics', 'Trigonometric Functions', '3D Geometry'];
            }
            
            // Filter by interests if any
            if (userData.interests.length > 0) {
                if (userData.interests.includes('algebra')) {
                    topics = topics.filter(t => t.toLowerCase().includes('algebra') || t.toLowerCase().includes('equation'));
                }
                if (userData.interests.includes('geometry')) {
                    topics = topics.filter(t => t.toLowerCase().includes('geometry'));
                }
                if (userData.interests.includes('trigonometry')) {
                    topics = topics.filter(t => t.toLowerCase().includes('trig'));
                }
            }
            
            recommendedTopics.innerHTML = `
                <p>Based on your form and interests, we recommend:</p>
                <ul>
                    ${topics.map(topic => `<li>${topic}</li>`).join('')}
                </ul>
            `;
        }

        function updateSettingsDisplay() {
            profileName.textContent = userData.name;
            profileForm.textContent = userData.form ? userData.form.charAt(0).toUpperCase() + userData.form.slice(1) : 'Not set';
            profileInterests.textContent = userData.interests.length > 0 
                ? userData.interests.map(i => i.charAt(0).toUpperCase() + i.slice(1)).join(', ')
                : 'Not set';
            profileGoals.textContent = userData.goals ? userData.goals.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ') : 'Not set';
            
            // Set toggle states
            darkModeToggle.checked = userData.settings.theme === 'dark';
            languageSelect.value = userData.settings.language;
            fontSizeSelect.value = userData.settings.fontSize;
            offlineModeToggle.checked = userData.settings.offlineMode;
        }

        // Check if user has already completed onboarding
        function checkExistingUser() {
            const savedUser = localStorage.getItem('ronexMathUser');
            if (savedUser) {
                userData = JSON.parse(savedUser);
                loginModal.classList.remove('active');
                updateDashboard();
                updateSettingsDisplay();
                
                // Apply saved theme
                if (userData.settings.theme === 'dark') {
                    document.body.classList.add('dark-theme');
                    document.getElementById('themeToggle').innerHTML = '<i class="fas fa-sun"></i>';
                }
                
                // Apply saved font size
                applyFontSize(userData.settings.fontSize);
            }
        }

        // File Management
        function loadFiles() {
            const savedFiles = JSON.parse(localStorage.getItem('ronexMathFiles') || '[]');
            filesContainer.innerHTML = '';
            
            if (savedFiles.length === 0) {
                filesContainer.innerHTML = '<p>No files uploaded yet.</p>';
                return;
            }
            
            savedFiles.forEach(file => {
                const fileCard = document.createElement('div');
                fileCard.className = 'file-card';
                fileCard.innerHTML = `
                    <div class="file-icon">
                        <i class="fas fa-file-pdf"></i>
                    </div>
                    <h4>${file.name}</h4>
                    <p>${file.size} KB</p>
                    <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">
                        <button class="btn btn-primary" onclick="viewFile('${file.id}')">View</button>
                        <button class="btn btn-outline" onclick="downloadFile('${file.id}')">Download</button>
                    </div>
                `;
                filesContainer.appendChild(fileCard);
            });
        }

        function uploadFile(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const fileData = {
                    id: Date.now().toString(),
                    name: file.name,
                    size: Math.round(file.size / 1024),
                    content: e.target.result,
                    type: file.type
                };
                
                const savedFiles = JSON.parse(localStorage.getItem('ronexMathFiles') || '[]');
                savedFiles.push(fileData);
                localStorage.setItem('ronexMathFiles', JSON.stringify(savedFiles));
                
                loadFiles();
                alert('File uploaded successfully!');
            };
            reader.readAsDataURL(file);
        }

        function viewFile(fileId) {
            const savedFiles = JSON.parse(localStorage.getItem('ronexMathFiles') || '[]');
            const file = savedFiles.find(f => f.id === fileId);
            
            if (file) {
                const newWindow = window.open();
                newWindow.document.write(`
                    <html>
                    <head><title>${file.name}</title></head>
                    <body style="margin: 0; padding: 20px;">
                        <h2>${file.name}</h2>
                        <embed src="${file.content}" width="100%" height="800px" type="${file.type}">
                        <div style="margin-top: 20px;">
                            <button onclick="window.print()">Print</button>
                            <button onclick="window.close()">Close</button>
                        </div>
                    </body>
                    </html>
                `);
            }
        }

        function downloadFile(fileId) {
            const savedFiles = JSON.parse(localStorage.getItem('ronexMathFiles') || '[]');
            const file = savedFiles.find(f => f.id === fileId);
            
            if (file) {
                const link = document.createElement('a');
                link.href = file.content;
                link.download = file.name;
                link.click();
            }
        }

        // Math Problems
        function loadMathProblems() {
            problemsContainer.innerHTML = '';
            
            const filteredTopic = topicFilter.value;
            const filteredForm = formFilter.value;
            
            const filteredProblems = mathProblems.filter(problem => {
                return (filteredTopic === 'all' || problem.topic === filteredTopic) &&
                       (filteredForm === 'all' || problem.form === filteredForm);
            });
            
            if (filteredProblems.length === 0) {
                problemsContainer.innerHTML = '<p>No problems found for the selected filters.</p>';
                return;
            }
            
            filteredProblems.forEach(problem => {
                const problemCard = document.createElement('div');
                problemCard.className = 'problem-card';
                problemCard.innerHTML = `
                    <h4>Problem ${problem.id}: ${problem.topic.charAt(0).toUpperCase() + problem.topic.slice(1)}</h4>
                    <p><strong>Question:</strong> ${problem.question}</p>
                    <div class="solution" id="solution-${problem.id}">
                        <p><strong>Solution:</strong> ${problem.solution}</p>
                        <p><strong>Notes:</strong> ${problem.notes}</p>
                    </div>
                    <button class="btn btn-primary" style="margin-top: 1rem;" onclick="toggleSolution(${problem.id})">Show Solution</button>
                    <button class="btn btn-outline" style="margin-top: 1rem;" onclick="markProblemSolved(${problem.id})">Mark as Solved</button>
                `;
                problemsContainer.appendChild(problemCard);
            });
        }

        function toggleSolution(problemId) {
            const solution = document.getElementById(`solution-${problemId}`);
            solution.classList.toggle('active');
            
            const button = solution.previousElementSibling;
            button.textContent = solution.classList.contains('active') ? 'Hide Solution' : 'Show Solution';
        }

        function markProblemSolved(problemId) {
            userData.progress.problemsSolved++;
            userData.progress.totalQuestions++;
            userData.progress.correctAnswers++;
            userData.progress.points += 10;
            
            // Update localStorage
            localStorage.setItem('ronexMathUser', JSON.stringify(userData));
            
            // Update dashboard
            updateDashboard();
            
            alert('Problem marked as solved! +10 points');
        }

        // Calculator Functions
        function updateCalculatorDisplay() {
            calcDisplay.textContent = calculatorState.currentValue;
        }

        function inputDigit(digit) {
            const { currentValue, waitingForNewValue } = calculatorState;
            
            if (waitingForNewValue) {
                calculatorState.currentValue = String(digit);
                calculatorState.waitingForNewValue = false;
            } else {
                calculatorState.currentValue = currentValue === '0' ? String(digit) : currentValue + digit;
            }
        }

        function inputDecimal() {
            if (calculatorState.waitingForNewValue) {
                calculatorState.currentValue = '0.';
                calculatorState.waitingForNewValue = false;
                return;
            }
            
            if (!calculatorState.currentValue.includes('.')) {
                calculatorState.currentValue += '.';
            }
        }

        function handleOperator(nextOperator) {
            const { currentValue, previousValue, operation } = calculatorState;
            const inputValue = parseFloat(currentValue);
            
            if (previousValue === null) {
                calculatorState.previousValue = inputValue;
            } else if (operation) {
                const currentValueNum = parseFloat(currentValue);
                const previousValueNum = parseFloat(previousValue);
                let result;
                
                switch (operation) {
                    case 'add':
                        result = previousValueNum + currentValueNum;
                        break;
                    case 'subtract':
                        result = previousValueNum - currentValueNum;
                        break;
                    case 'multiply':
                        result = previousValueNum * currentValueNum;
                        break;
                    case 'divide':
                        result = previousValueNum / currentValueNum;
                        break;
                    case 'percentage':
                        result = previousValueNum * (currentValueNum / 100);
                        break;
                    default:
                        return;
                }
                
                calculatorState.currentValue = String(result);
                calculatorState.previousValue = result;
            }
            
            calculatorState.waitingForNewValue = true;
            calculatorState.operation = nextOperator;
        }

        function performCalculation() {
            const { currentValue, previousValue, operation } = calculatorState;
            const inputValue = parseFloat(currentValue);
            
            if (previousValue === null || operation === null) {
                return;
            }
            
            const previousValueNum = parseFloat(previousValue);
            let result;
            
            switch (operation) {
                case 'add':
                    result = previousValueNum + inputValue;
                    break;
                case 'subtract':
                    result = previousValueNum - inputValue;
                    break;
                case 'multiply':
                    result = previousValueNum * inputValue;
                    break;
                case 'divide':
                    result = previousValueNum / inputValue;
                    break;
                case 'percentage':
                    result = previousValueNum * (inputValue / 100);
                    break;
                default:
                    return;
            }
            
            calculatorState.currentValue = String(result);
            calculatorState.previousValue = null;
            calculatorState.operation = null;
            calculatorState.waitingForNewValue = true;
        }

        function resetCalculator() {
            calculatorState = {
                currentValue: '0',
                previousValue: null,
                operation: null,
                waitingForNewValue: false
            };
        }

        function backspace() {
            if (calculatorState.currentValue.length > 1) {
                calculatorState.currentValue = calculatorState.currentValue.slice(0, -1);
            } else {
                calculatorState.currentValue = '0';
            }
        }

        // Graph Plotter
        function plotGraph() {
            const equation = graphEquation.value.trim();
            if (equation) {
                calculator.setExpression({ id: 'graph1', latex: `y = ${equation}` });
            } else {
                alert('Please enter an equation to plot');
            }
        }

        // Equation Solver
        function solveEquation() {
            const equation = equationInput.value.trim();
            if (!equation) {
                equationResult.innerHTML = '<p>Please enter an equation to solve.</p>';
                return;
            }
            
            try {
                // Simple equation solving for demonstration
                if (equation.includes('=')) {
                    const sides = equation.split('=');
                    const leftSide = sides[0].trim();
                    const rightSide = sides[1].trim();
                    
                    // For simple linear equations: ax + b = c
                    if (leftSide.includes('x') && !rightSide.includes('x')) {
                        // Extract coefficient and constant
                        const leftParts = leftSide.split(/(?=[+-])/);
                        let coefficient = 0;
                        let constant = 0;
                        
                        leftParts.forEach(part => {
                            if (part.includes('x')) {
                                const coef = part.replace('x', '').trim();
                                if (coef === '' || coef === '+') coefficient += 1;
                                else if (coef === '-') coefficient -= 1;
                                else coefficient += parseFloat(coef);
                            } else {
                                constant += parseFloat(part);
                            }
                        });
                        
                        const rightValue = parseFloat(rightSide);
                        const solution = (rightValue - constant) / coefficient;
                        
                        equationResult.innerHTML = `
                            <p><strong>Equation:</strong> ${equation}</p>
                            <p><strong>Solution:</strong> x = ${solution}</p>
                            <p><strong>Steps:</strong></p>
                            <ol>
                                <li>${leftSide} = ${rightSide}</li>
                                <li>${coefficient}x = ${rightValue - constant}</li>
                                <li>x = ${(rightValue - constant)} / ${coefficient}</li>
                                <li>x = ${solution}</li>
                            </ol>
                        `;
                    } else {
                        equationResult.innerHTML = '<p>This equation solver currently supports simple linear equations of the form ax + b = c.</p>';
                    }
                } else {
                    equationResult.innerHTML = '<p>Please enter a valid equation with an equals sign (=).</p>';
                }
            } catch (error) {
                equationResult.innerHTML = '<p>Error solving equation. Please check your input format.</p>';
            }
        }

        // Formula Explorer
        function loadFormulas() {
            formulasContainer.innerHTML = '';
            const searchTerm = formulaSearch.value.toLowerCase();
            
            const filteredFormulas = mathFormulas.filter(formula => {
                return formula.name.toLowerCase().includes(searchTerm) || 
                       formula.topic.toLowerCase().includes(searchTerm) ||
                       formula.description.toLowerCase().includes(searchTerm);
            });
            
            if (filteredFormulas.length === 0) {
                formulasContainer.innerHTML = '<p>No formulas found matching your search.</p>';
                return;
            }
            
            filteredFormulas.forEach(formula => {
                const formulaCard = document.createElement('div');
                formulaCard.className = 'formula-card';
                formulaCard.innerHTML = `
                    <h4>${formula.name}</h4>
                    <p><strong>Formula:</strong> ${formula.formula}</p>
                    <p>${formula.description}</p>
                    <p><strong>Topic:</strong> ${formula.topic.charAt(0).toUpperCase() + formula.topic.slice(1)}</p>
                `;
                formulasContainer.appendChild(formulaCard);
            });
        }

        // Practice Generator
        function generatePracticeProblems() {
            const topic = practiceTopic.value;
            const form = practiceForm.value;
            const difficulty = practiceDifficulty.value;
            
            // Filter problems based on selections
            const filteredProblems = mathProblems.filter(problem => {
                return (topic === 'all' || problem.topic === topic) &&
                       (form === 'all' || problem.form === form);
            });
            
            // Limit to 5 problems for demonstration
            const practiceSet = filteredProblems.slice(0, 5);
            
            if (practiceSet.length === 0) {
                practiceProblems.innerHTML = '<p>No problems found for the selected criteria.</p>';
                return;
            }
            
            let practiceHTML = '<h4>Practice Problems</h4>';
            practiceSet.forEach((problem, index) => {
                practiceHTML += `
                    <div class="problem-card" style="margin-bottom: 1rem;">
                        <h5>Problem ${index + 1}</h5>
                        <p><strong>Question:</strong> ${problem.question}</p>
                        <div class="solution" id="practice-solution-${problem.id}">
                            <p><strong>Solution:</strong> ${problem.solution}</p>
                            <p><strong>Notes:</strong> ${problem.notes}</p>
                        </div>
                        <button class="btn btn-primary" style="margin-top: 0.5rem;" onclick="togglePracticeSolution(${problem.id})">Show Solution</button>
                        <button class="btn btn-outline" style="margin-top: 0.5rem;" onclick="markProblemSolved(${problem.id})">Mark as Solved</button>
                    </div>
                `;
            });
            
            practiceProblems.innerHTML = practiceHTML;
        }

        function togglePracticeSolution(problemId) {
            const solution = document.getElementById(`practice-solution-${problemId}`);
            solution.classList.toggle('active');
            
            const button = solution.previousElementSibling;
            button.textContent = solution.classList.contains('active') ? 'Hide Solution' : 'Show Solution';
        }

        // Notes Modal
        function showNotes(topic) {
            if (syllabusNotes[topic]) {
                notesTitle.textContent = syllabusNotes[topic].title;
                notesContent.innerHTML = syllabusNotes[topic].content;
                notesModal.classList.add('active');
            } else {
                alert('Notes for this topic are not available yet.');
            }
        }

        // WhatsApp Integration
        function openWhatsAppModal() {
            whatsappModal.classList.add('active');
        }

        function sendWhatsAppMessage() {
            const problem = problemDescription.value.trim();
            const form = whatsappForm.value;
            const topic = whatsappTopic.value;
            const attempted = attemptedSolution.value.trim();
            const difficulty = specificDifficulty.value.trim();
            
            if (!problem) {
                alert('Please describe the problem you need help with.');
                return;
            }
            
            // Format the message
            const message = `Hello Ronex, I need help with a math problem:
            
Problem: ${problem}
Form: ${form.charAt(0).toUpperCase() + form.slice(1)}
Topic: ${topic.charAt(0).toUpperCase() + topic.slice(1)}
What I've tried: ${attempted || 'Nothing yet'}
Where I'm stuck: ${difficulty || 'Not sure'}

Please help me understand how to solve this. Thank you!`;
            
            // Encode the message for URL
            const encodedMessage = encodeURIComponent(message);
            
            // Create WhatsApp URL (using a placeholder number)
            const whatsappURL = `https://wa.me/263771234567?text=${encodedMessage}`;
            
            // Open WhatsApp
            window.open(whatsappURL, '_blank');
            
            // Close modal
            whatsappModal.classList.remove('active');
            
            // Reset form
            problemDescription.value = '';
            attemptedSolution.value = '';
            specificDifficulty.value = '';
        }

        // Quiz System
        function startDailyQuiz() {
            quizState.quizActive = true;
            quizState.currentQuestion = 0;
            quizState.score = 0;
            quizState.selectedOption = null;
            
            dailyQuiz.style.display = 'block';
            loadQuizQuestion();
        }

        function loadQuizQuestion() {
            const question = quizQuestions[quizState.currentQuestion];
            
            quizQuestion.textContent = question.question;
            quizOptions.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'quiz-option';
                optionElement.textContent = option;
                optionElement.dataset.index = index;
                optionElement.addEventListener('click', selectQuizOption);
                quizOptions.appendChild(optionElement);
            });
            
            quizResult.className = 'quiz-result';
            quizResult.style.display = 'none';
            submitQuizBtn.style.display = 'block';
            nextQuizBtn.style.display = 'none';
        }

        function selectQuizOption(event) {
            // Remove selected class from all options
            document.querySelectorAll('.quiz-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selected class to clicked option
            event.target.classList.add('selected');
            quizState.selectedOption = parseInt(event.target.dataset.index);
        }

        function submitQuizAnswer() {
            if (quizState.selectedOption === null) {
                alert('Please select an answer before submitting.');
                return;
            }
            
            const question = quizQuestions[quizState.currentQuestion];
            const isCorrect = quizState.selectedOption === question.correctAnswer;
            
            if (isCorrect) {
                quizResult.className = 'quiz-result correct';
                quizResult.innerHTML = `<p><strong>Correct!</strong> ${question.explanation}</p>`;
                quizState.score++;
                
                // Update user progress
                userData.progress.totalQuestions++;
                userData.progress.correctAnswers++;
                userData.progress.points += 5;
                localStorage.setItem('ronexMathUser', JSON.stringify(userData));
                updateDashboard();
            } else {
                quizResult.className = 'quiz-result incorrect';
                quizResult.innerHTML = `<p><strong>Incorrect.</strong> The correct answer is: ${question.options[question.correctAnswer]}. ${question.explanation}</p>`;
                
                // Update user progress
                userData.progress.totalQuestions++;
                localStorage.setItem('ronexMathUser', JSON.stringify(userData));
                updateDashboard();
            }
            
            quizResult.style.display = 'block';
            submitQuizBtn.style.display = 'none';
            nextQuizBtn.style.display = 'block';
        }

        function nextQuizQuestion() {
            quizState.currentQuestion++;
            
            if (quizState.currentQuestion < quizQuestions.length) {
                loadQuizQuestion();
            } else {
                endQuiz();
            }
        }

        function endQuiz() {
            dailyQuiz.style.display = 'none';
            
            // Check if user completed the daily challenge
            if (quizState.score >= 3) { // At least 3 correct answers
                userData.progress.dailyChallengeCompleted = true;
                userData.progress.points += 20; // Bonus points for completing challenge
                localStorage.setItem('ronexMathUser', JSON.stringify(userData));
                updateDashboard();
                
                alert(`Quiz completed! You scored ${quizState.score}/${quizQuestions.length}. Daily challenge completed! +20 bonus points.`);
            } else {
                alert(`Quiz completed! You scored ${quizState.score}/${quizQuestions.length}. Try again tomorrow to complete the daily challenge.`);
            }
        }

        // AI Assistant with API integration
        async function getMathDefinition(term) {
            try {
                const response = await axios.get(`https://api.dictionaryapi.dev/api/v2/entries/en/${term}`);
                if (response.data && response.data[0]) {
                    return response.data[0].meanings[0].definitions[0].definition;
                }
                return null;
            } catch (error) {
                return null;
            }
        }

        function generateAIResponse(userMessage) {
            const lowerMessage = userMessage.toLowerCase();
            
            // Check for math definitions
            const mathTerms = ['algebra', 'geometry', 'trigonometry', 'calculus', 'equation', 'function', 'derivative', 'integral'];
            for (const term of mathTerms) {
                if (lowerMessage.includes(term)) {
                    return `I see you're asking about ${term}. Would you like me to explain this concept in more detail or help you with a specific problem related to ${term}?`;
                }
            }
            
            // Check for specific problem types
            if (lowerMessage.includes('solve') || lowerMessage.includes('equation')) {
                return "I can help you solve equations. Could you provide the specific equation you're working with? For example, '2x + 5 = 13'";
            }
            
            if (lowerMessage.includes('area') || lowerMessage.includes('volume')) {
                return "I can help with area and volume calculations. What shape are you working with? (e.g., circle, rectangle, triangle, cylinder)";
            }
            
            if (lowerMessage.includes('graph') || lowerMessage.includes('plot')) {
                return "I can help you understand graphing functions. What specific function would you like to graph?";
            }
            
            // Default responses
            const defaultResponses = [
                "I'd be happy to help with that math problem. Could you provide more details?",
                "That's an interesting math question. Let me break it down step by step for you.",
                "I understand you're working on this topic. Have you tried approaching it from a different angle?",
                "Based on your question, I recommend reviewing the fundamental concepts first. Would you like me to explain them?",
                "I can help solve that for you. What specific part are you having trouble with?"
            ];
            
            return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
        }

        // Settings Application
        function applyFontSize(size) {
            document.body.style.fontSize = 
                size === 'small' ? '14px' : 
                size === 'medium' ? '16px' : '18px';
        }

        // Tool Management
        function showTool(toolId) {
            // Hide all tool containers
            document.querySelectorAll('.tool-container').forEach(container => {
                container.classList.remove('active');
            });
            
            // Show the selected tool
            document.getElementById(toolId).classList.add('active');
        }

        // Mobile Navigation Functionality
        document.addEventListener('DOMContentLoaded', function() {
            const hamburgerMenu = document.getElementById('hamburgerMenu');
            const mobileNav = document.getElementById('mobileNav');
            const mobileOverlay = document.getElementById('mobileOverlay');
            const closeMobileNav = document.getElementById('closeMobileNav');
            
            // Toggle mobile navigation when hamburger menu is clicked
            hamburgerMenu.addEventListener('click', function() {
                this.classList.toggle('active');
                mobileNav.classList.toggle('active');
                mobileOverlay.classList.toggle('active');
            });
            
            // Close mobile navigation when close button is clicked
            closeMobileNav.addEventListener('click', function() {
                hamburgerMenu.classList.remove('active');
                mobileNav.classList.remove('active');
                mobileOverlay.classList.remove('active');
            });
            
            // Close mobile navigation when overlay is clicked
            mobileOverlay.addEventListener('click', function() {
                hamburgerMenu.classList.remove('active');
                mobileNav.classList.remove('active');
                this.classList.remove('active');
            });
            
            // Close mobile navigation when a link is clicked
            document.querySelectorAll('.mobile-nav-links a').forEach(link => {
                link.addEventListener('click', function() {
                    hamburgerMenu.classList.remove('active');
                    mobileNav.classList.remove('active');
                    mobileOverlay.classList.remove('active');
                });
            });
            
            // Page Navigation
            const navLinks = document.querySelectorAll('.nav-link');
            const pages = document.querySelectorAll('.page');
            
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    
                    // Remove active class from all links and pages
                    navLinks.forEach(l => l.classList.remove('active'));
                    pages.forEach(p => p.classList.remove('active'));
                    
                    // Add active class to clicked link and corresponding page
                    link.classList.add('active');
                    const pageId = link.getAttribute('data-page');
                    document.getElementById(pageId).classList.add('active');
                });
            });
            
            // Theme Toggle
            const themeToggle = document.getElementById('themeToggle');
            const body = document.body;
            
            themeToggle.addEventListener('click', () => {
                body.classList.toggle('dark-theme');
                if (body.classList.contains('dark-theme')) {
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                    userData.settings.theme = 'dark';
                } else {
                    themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
                    userData.settings.theme = 'light';
                }
                localStorage.setItem('ronexMathUser', JSON.stringify(userData));
            });

            // Check for saved theme preference
            if (localStorage.getItem('theme') === 'dark') {
                body.classList.add('dark-theme');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            }
            
            // AI Assistant
            aiToggle.addEventListener('click', () => {
                aiChat.classList.toggle('active');
            });
            
            closeAiChat.addEventListener('click', () => {
                aiChat.classList.remove('active');
            });
            
            sendAiMessage.addEventListener('click', sendMessage);
            aiInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            async function sendMessage() {
                const message = aiInput.value.trim();
                if (message) {
                    // Add user message
                    addMessage(message, 'user');
                    aiInput.value = '';
                    
                    // Generate and add AI response
                    const response = await generateAIResponse(message);
                    addMessage(response, 'bot');
                }
            }
            
            function addMessage(text, sender) {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('message', sender);
                messageDiv.textContent = text;
                aiMessages.appendChild(messageDiv);
                aiMessages.scrollTop = aiMessages.scrollHeight;
            }
            
            // Settings functionality
            darkModeToggle.addEventListener('change', () => {
                if (darkModeToggle.checked) {
                    body.classList.add('dark-theme');
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                    userData.settings.theme = 'dark';
                } else {
                    body.classList.remove('dark-theme');
                    themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
                    userData.settings.theme = 'light';
                }
                localStorage.setItem('ronexMathUser', JSON.stringify(userData));
            });
            
            languageSelect.addEventListener('change', () => {
                userData.settings.language = languageSelect.value;
                localStorage.setItem('ronexMathUser', JSON.stringify(userData));
                // In a real app, we would update the UI language here
            });
            
            fontSizeSelect.addEventListener('change', () => {
                userData.settings.fontSize = fontSizeSelect.value;
                localStorage.setItem('ronexMathUser', JSON.stringify(userData));
                applyFontSize(fontSizeSelect.value);
            });
            
            offlineModeToggle.addEventListener('change', () => {
                userData.settings.offlineMode = offlineModeToggle.checked;
                localStorage.setItem('ronexMathUser', JSON.stringify(userData));
            });
            
            logoutBtn.addEventListener('click', () => {
                if (confirm('Are you sure you want to logout?')) {
                    localStorage.removeItem('ronexMathUser');
                    location.reload();
                }
            });
            
            clearCacheBtn.addEventListener('click', () => {
                if (confirm('This will clear all cached data. Are you sure?')) {
                    localStorage.removeItem('ronexMathFiles');
                    loadFiles();
                    alert('Cache cleared successfully');
                }
            });
            
            editProfileBtn.addEventListener('click', () => {
                loginModal.classList.add('active');
                showStep(1);
            });
            
            startChallengeBtn.addEventListener('click', startDailyQuiz);
            
            downloadNotesBtn.addEventListener('click', () => {
                alert('Downloading comprehensive math notes...');
                // In a real implementation, this would download notes
            });
            
            backupDataBtn.addEventListener('click', () => {
                alert('Data backup created successfully!');
                // In a real implementation, this would backup user data
            });
            
            // File Management
            browseFilesBtn.addEventListener('click', () => {
                fileInput.click();
            });
            
            fileInput.addEventListener('change', (e) => {
                const files = e.target.files;
                for (let i = 0; i < files.length; i++) {
                    uploadFile(files[i]);
                }
                fileInput.value = '';
            });
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = 'var(--primary)';
                uploadArea.style.backgroundColor = 'rgba(67, 97, 238, 0.1)';
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.style.borderColor = 'var(--gray)';
                uploadArea.style.backgroundColor = 'transparent';
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = 'var(--gray)';
                uploadArea.style.backgroundColor = 'transparent';
                
                const files = e.dataTransfer.files;
                for (let i = 0; i < files.length; i++) {
                    uploadFile(files[i]);
                }
            });
            
            // Math Problems
            searchProblemsBtn.addEventListener('click', loadMathProblems);
            
            // Syllabus Notes
            document.querySelectorAll('.syllabus-card li').forEach(item => {
                item.addEventListener('click', function() {
                    const topic = this.dataset.topic;
                    showNotes(topic);
                });
            });
            
            // WhatsApp Help
            whatsappHelpBtn.addEventListener('click', openWhatsAppModal);
            closeWhatsAppBtn.addEventListener('click', () => {
                whatsappModal.classList.remove('active');
            });
            sendWhatsAppBtn.addEventListener('click', sendWhatsAppMessage);
            
            // Tools
            calculatorTool.addEventListener('click', () => {
                showTool('calculatorContainer');
            });
            
            graphTool.addEventListener('click', () => {
                showTool('graphPlotterContainer');
            });
            
            equationSolverTool.addEventListener('click', () => {
                showTool('equationSolverContainer');
            });
            
            formulaExplorerTool.addEventListener('click', () => {
                showTool('formulaExplorerContainer');
                loadFormulas();
            });
            
            practiceGeneratorTool.addEventListener('click', () => {
                showTool('practiceGeneratorContainer');
            });
            
            // Calculator
            calcButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const { action } = button.dataset;
                    const { value } = button.dataset;
                    
                    if (value) {
                        inputDigit(value);
                    } else if (action === 'decimal') {
                        inputDecimal();
                    } else if (action === 'clear') {
                        resetCalculator();
                    } else if (action === 'backspace') {
                        backspace();
                    } else if (action === 'calculate') {
                        performCalculation();
                    } else {
                        handleOperator(action);
                    }
                    
                    updateCalculatorDisplay();
                });
            });
            
            // Graph Plotter
            plotGraphBtn.addEventListener('click', plotGraph);
            
            // Equation Solver
            solveEquationBtn.addEventListener('click', solveEquation);
            
            // Formula Explorer
            formulaSearch.addEventListener('input', loadFormulas);
            
            // Practice Generator
            generatePracticeBtn.addEventListener('click', generatePracticeProblems);
            
            // Quiz System
            submitQuizBtn.addEventListener('click', submitQuizAnswer);
            nextQuizBtn.addEventListener('click', nextQuizQuestion);
            
            // Notes Modal
            closeNotesBtn.addEventListener('click', () => {
                notesModal.classList.remove('active');
            });
            
            // Initialize progress chart
            const progressCtx = document.getElementById('progressChart').getContext('2d');
            const progressChart = new Chart(progressCtx, {
                type: 'line',
                data: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6'],
                    datasets: [{
                        label: 'Correct Answers %',
                        data: [65, 70, 75, 80, 78, 85],
                        borderColor: '#4361ee',
                        backgroundColor: 'rgba(67, 97, 238, 0.1)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Weekly Performance'
                        }
                    }
                }
            });
            
            // Check for existing user on page load
            checkExistingUser();
            loadFiles();
            loadMathProblems();
            loadFormulas();
        });
    </script>
</body>
</html>